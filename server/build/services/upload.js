var express=require("express"),router=express.Router(),multer=require("multer"),helpers=require("./../lib/helpers"),drive=require("./../lib/gdrive"),storage=multer.diskStorage({destination:function(a,b,c){c(null,"uploads/")},filename:function(a,b,c){var d=b.mimetype.split("/")[1];console.log(d),c(null,b.originalname)}}),upload=multer({storage:storage});module.exports.getRouter=function(a){return router.post("/upload",upload.single("file"),function(a,b){console.log("photo upload"),console.log(a.file.mimetype),helpers.sendErrorResponse(b,""),console.log("filename "+a.file.originalname);var c=a.body.user+"##"+a.body.id;drive.uploadToGoogledrive("uploads/"+a.file.originalname,c)}),router.use("/uploads/:fname",function(a,b){console.log(a.params.fname),console.log("test"),b.sendFile("secondarytile.png",{root:__dirname+"/../uploads"})}),router};